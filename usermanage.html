<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>账户管理</title>
    <link rel="stylesheet" href="css/usermanage.css">


</head>
<body>
<div class="tk1">
    <div class="title">
        <div class="head">
            <div class="left">新建学生</div>
            <div class="close"><img src="img/错误.jpg" alt=""></div>
        </div>
    </div>
    <div class="loadname">
        <div class="left">登录名</div>
        <input type="text">
    </div>
    <div class="loadname bb">
        <div class="left">姓名</div>
        <input type="text">
    </div>
    <div class="loadname bb">
        <div class="left">学号</div>
        <input type="text">
    </div>
    <div class="loadname bb">
        <div class="left">性别</div>
        <input type="text">
    </div>
    <div class="loadname bb">
        <div class="left">专业(系)</div>
        <input type="text">
    </div>
    <div class="loadname bb">
        <div class="left">院校</div>
        <input type="text">
    </div>
    <div class="loadname bb">
        <div class="left">班级</div>
        <input type="text">
    </div>
    <div class="ending">
        <div class="save">保存</div>
        <div class="cannle">取消</div>
    </div>

</div>
<div class="tk">
    <div class="title">
        <div class="head">
            <div class="left">批量导入</div>
            <div class="close"><img src="img/错误.jpg" alt=""></div>
        </div>
    </div>
    <div class="row-one">
        <div class="dot">!</div>
        <div class="word">如果未下载过模板，请下载</div>
        <button class="download">下载模板</button>
    </div>
    <div class="row-one two">
        <div class="dot">!</div>
        <div class="word">如果已下载过模板，请导入</div>
        <button class="download">批量导入</button>
    </div>
</div>

<div class="Ndhz">
    <div class="Ndsjpt">
        <div class="Ntp">
            <div class="Nyyk"><img src="img/youyike.png" alt=""></div>
            <div class="Nz"><p>大数据实验平台</p></div>
        </div>
        <div class="Np">
            <img src="img/touxiang.png" alt="">
            <div class="Ny"><p>管理员身份&nbsp;&or;</p></div>
        </div>

    </div>
    <div class="Nnr">
        <div class="Nxxk">
            <ul>
                <li><a href="jqgl.html">集群管理</a></li>
                <li><a href="xuexiziliao.html">学习资料</a></li>
                <li><a href="fenleiguanli.html">分类管理</a></li>
                <li class="active"><a href="usermanage.html">账户管理</a></li>
                <li><a href="ziyuanguanli1.html">资源管理</a></li>
                <li><a href="goumai1.html">购买记录</a></li>
            </ul>
        </div>
        <div class="Nh">
            <div class="Cyj_content">
                <div class="Cyj_title">
                    <h2 style="font-size: 14px;">账户管理/用户列表</h2>
                </div>
                <div class="GZC_big-box">
                    <div class="GZC_login_name">
                        <select name="登录名" id="登录名">
                            <option value="">登录名</option>
                            <option value="">学号</option>
                        </select>
                        <div class="center">
                            <input type="text">
                        </div>
                        <button>搜索学生</button>
                    </div>
                    <div class="choose">
                        <button class="new">新建学生</button>
                        <button class="batch">批量导入</button>
                    </div>
                </div>
            </div>
            <div class="GZC_table">
                <div class="row">
                    <div class="person">
                        <img src="img/QQ图片20180906162255.png" alt="">
                        <h3>学生用户</h3></div>
                    <div class="dr">
                        <button class="delete">删除</button>
                        <button class="return">刷新</button>
                    </div>
                </div>
                <div class="tb">
                    <div class="form">
                        <div class="b1 a"><input type="checkbox" name="ifAll" id="ifAll" onClick="checkAll()"></div>
                        <div class="b2 a">登录名</div>
                        <div class="b3 a">姓名</div>
                        <div class="b4 a">学号</div>
                        <div class="b5 a">性别</div>
                        <div class="b6 a">专业(系)</div>
                        <div class="b7 a">院校</div>
                        <div class="b8 a">班级</div>
                        <div class="b9 a">操作</div>
                    </div>
                </div>

                <div class="big-form">没有找到匹配的记录！</div>
                <div class="Cyj_bottom">
                    <ul>
                        <li class="Cyj_one">上一页</li>
                        <li style="background-color: #4381e6;color: #fff">1</li>
                        <li>2</li>
                        <li>3</li>
                        <li style="border:none;">......</li>
                        <li>9</li>
                        <li>10</li>
                        <li class="Cyj_one">下一页</li>
                        <li class="Cyj_two">尾页</li>
                    </ul>
                </div>
                <!-- <div class="page">
                    <div class="fenye">
                        <div class="on">上一页</div>
                        <div class="one">1</div>
                        <div class="two">2</div>
                        <div class="three">3</div>
                        <span>.....</span>
                        <div class="nine">9</div>
                        <div class="ten">10</div>
                        <div class="down">下一页</div>
                        <div class="end">尾页</div>
                    </div>
                </div> -->
            </div>
        </div>

    </div>
    <div class="Ndibu">c 2017-2018 http://sxuek.com山西优逸客科技有限公司版权所有</div>
</div>

</body>
</html>
<script>
    let batch = document.querySelector(".batch");
    let news = document.querySelector(".new");
    let tk1 = document.querySelector(".tk1");
    let tk = document.querySelector(".tk");
    let close1 = document.querySelector(".tk1 .close");
    let close = document.querySelector(".tk .close");
    let save = document.querySelector(".save");
    let form = document.querySelector(".big-form");
    let refresh=document.querySelector(".return");
    let del=document.querySelector(".form .b9 button .del");
    console.log(del);
    // console.log(refresh);
    // console.log(form);
    // console.log(batch, news);
    batch.onclick = function () {
        tk.style.display = "block";
    }
    news.onclick = function () {
        tk1.style.display = "block";
    }
    close1.onclick = function () {
        tk1.style.display = "none";
    }
    close.onclick = function () {
        tk.style.display = "none";
    }


    function checkAll() {
        for (var i = 0; i < document.getElementsByName("selectFlag").length; i++) {
            document.getElementsByName("selectFlag")[i].checked = document.getElementById("ifAll").checked;
        }
    }


    // let submit = document.querySelector(".save");
    let table = document.querySelector(".tb");
    let inpts = document.querySelectorAll(".loadname input");
    // console.log(inpts);
    // let main = [
    //     {id:1,name: "张三", sex: "男", age: "18", classes: "WUIF18", number: "001",},
    //     {id:2,name: "张三", sex: "男", age: "18", classes: "WUIF18", number: "001",},
    //     {id:3,name: "张三", sex: "男", age: "18", classes: "WUIF18", number: "001",},
    //     {id:4,name: "张三", sex: "男", age: "18", classes: "WUIF18", number: "001",},
    //     {id:5,name: "张三", sex: "男", age: "18", classes: "WUIF18", number: "001",},
    // ];
    // //存入本地库
    // localStorage.studentinfo=JSON.stringify(main);
    let data = JSON.parse(localStorage.studentinfo);
    //默认行
    data.forEach(element => createtr(element));
    //添加行
    save.onclick = function () {
        let obj = {
            id: "", load: inpts[0].value, name: inpts[1].value, number: inpts[2].value,
            sex: inpts[3].value,
            zhuanye: inpts[4].value,
            yuan: inpts[5].value,
            classes: inpts[6].value,
        };
        obj.id = data.length;
        // let ids = data.length + 1;
        console.log(data.push(obj));
        createtr(obj);
        localStorage.studentinfo = JSON.stringify(data);
        // inputs.onblur = function () {
        //     let newv = inputs.value;
        //     element.removeChild(inputs);
        //     element.innerHTML = newv;
        // }
        // if ()
        tk1.style.display = "none";
        form.style.display = "none";
        function reloadPage(){
            location.reload()
        }
         refresh.onclick=function(){
             reloadPage();
             form.display = "none";
         }


       // let obj = {
       //      id: "", load: "", name: "", number: "",
       //      sex: "",
       //      zhuanye: "",
       //      yuan: "",
       //      classes: "",
       //  };


        // tk.style.display = "none";


    }
    //删除、修改
    table.ondblclick = function (e) {
        let element = e.target;
        // let ids = data.length;
        let type = element.getAttribute("type");
        if (element.nodeName == "DIV" && element.className != "d") {
            let oldv = element.innerHTML;
            element.innerHTML = "";
            let inputs = document.createElement("input");
            inputs.value = oldv;
            element.appendChild(inputs);


            inputs.onblur = function () {
                let newv = inputs.value;
                let trs=element.parentNode;
                let ids=trs.id;
                // console.log(ids);
                element.removeChild(inputs);

                element.innerHTML = newv;
                // console.log(element.innerHTML);
                let result = data.filter(v => v.id == ids);
                console.log(result);
                result[0][type] = newv;
                // console.log(result[0][type]);
                localStorage.studentinfo=JSON.stringify(data);
            }
        } else if (element.nodeName == "BUTTON") {
            let strs = element.parentNode.parentNode;
            table.removeChild(strs);
            let ids=strs.id;
            // console.log(ids);
            data = data.filter(v => v.id != ids);
            localStorage.studentinfo = JSON.stringify(data);

        }
    }

    function createtr(obj) {
        let str = `<div class="form" id="${obj.id}">
                        <div class="b1 a "><input type="checkbox" name="selectFlag"></div>
                        <div class="b2 a load">${obj.load}</div>
                        <div class="b3 a name">${obj.name}</div>
                        <div class="b4 a number">${obj.number}</div>
                        <div class="b5 a sex">${obj.sex}</div>
                        <div class="b6 a zhuanye">${obj.zhuanye}</div>
                        <div class="b7 a yuan">${obj.yuan}</div>
                        <div class="b8 a classes">${obj.classes}</div>
                        <!--<div class="b9 a"><button class="del">DEL</button></div>-->
                        <div class="b9 a">
                            <button class="del"   style="
    border: none;
    outline: none;
    color: rgba(0,0,0,0.4);
    border-radius: 4px;
    background-color: #f9f9f9;
    line-height: 30px;
    font-size: 12px;
">删除</button>
                        </div>
                    </div>`;
        table.innerHTML += str;
    }
</script>